#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import sys
import math
from typing import List, Optional, Tuple


def get_coefficient(prompt: str, arg_value: Optional[str] = None) -> float:
    """
    –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

    Args:
        prompt: –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥–ª—è –≤–≤–æ–¥–∞
        arg_value: –ó–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)

    Returns:
        float: –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç
    """
    # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
    if arg_value is not None:
        try:
            value = float(arg_value)
            print(f"{prompt}{value} (–∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏)")
            return value
        except ValueError:
            print(f"‚ö†Ô∏è  –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ '{arg_value}' –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ.")

    # –ï—Å–ª–∏ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –≤–≤–æ–¥–∏–º —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    while True:
        try:
            value = float(input(prompt))
            return value
        except ValueError:
            print("‚ö†Ô∏è  –û—à–∏–±–∫–∞! –í–≤–µ–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ.")
        except KeyboardInterrupt:
            print("\n\nüëã –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.")
            sys.exit(0)


def solve_quadratic(a: float, b: float, c: float) -> List[float]:
    """
    –†–µ—à–µ–Ω–∏–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è a*y^2 + b*y + c = 0.

    Args:
        a, b, c: –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —É—Ä–∞–≤–Ω–µ–Ω–∏—è

    Returns:
        List[float]: –°–ø–∏—Å–æ–∫ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π
    """
    roots = []

    # –í—ã—Ä–æ–∂–¥–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π: a = 0
    if a == 0:
        if b == 0:
            # –£—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∏–¥–∞ c = 0
            if c == 0:
                print("‚ÑπÔ∏è  –£—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–º–µ–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –º–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏–π.")
            else:
                print("‚ÑπÔ∏è  –£—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ –∏–º–µ–µ—Ç —Ä–µ—à–µ–Ω–∏–π.")
        else:
            # –õ–∏–Ω–µ–π–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: b*y + c = 0
            y = -c / b
            print(f"üìå –õ–∏–Ω–µ–π–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: y = {y:.6f}")
            if y >= 0:  # –î–ª—è –±–∏–∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ –Ω—É–∂–Ω—ã –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ y
                roots.append(y)
        return roots

    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç–∞
    discriminant = b**2 - 4*a*c

    print(f"\nüìä –ö–≤–∞–¥—Ä–∞—Ç–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: {a}*y¬≤ + {b}*y + {c} = 0")
    print(f"üìê –î–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç D = {discriminant:.6f}")

    if discriminant < 0:
        print("‚ÑπÔ∏è  –î–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π - –Ω–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π.")
        return roots

    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—Ä–Ω–µ–π –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è
    sqrt_d = math.sqrt(discriminant)
    y1 = (-b + sqrt_d) / (2 * a)
    y2 = (-b - sqrt_d) / (2 * a)

    print(f"‚úì –ö–æ—Ä–Ω–∏ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è:")
    print(f"  y‚ÇÅ = {y1:.6f}")
    print(f"  y‚ÇÇ = {y2:.6f}")

    # –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ—Ä–Ω–∏ (–¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–æ—Ä–Ω—è)
    if y1 >= 0:
        roots.append(y1)
    if y2 >= 0 and abs(y1 - y2) > 1e-10:  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω–æ—Å—Ç—å
        roots.append(y2)

    return roots


def solve_biquadratic(a: float, b: float, c: float) -> List[float]:
    """
    –†–µ—à–µ–Ω–∏–µ –±–∏–∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è A*x^4 + B*x^2 + C = 0.

    Args:
        a, b, c: –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —É—Ä–∞–≤–Ω–µ–Ω–∏—è

    Returns:
        List[float]: –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π
    """
    print("\n" + "="*60)
    print(f"üî¢ –ë–∏–∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ: {a}*x‚Å¥ + {b}*x¬≤ + {c} = 0")
    print("="*60)

    # –ó–∞–º–µ–Ω–∞ y = x^2, –ø–æ–ª—É—á–∞–µ–º a*y^2 + b*y + c = 0
    print("\nüîÑ –ó–∞–º–µ–Ω–∞: y = x¬≤")

    y_roots = solve_quadratic(a, b, c)

    if not y_roots:
        print("\n‚ùå –ë–∏–∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ –∏–º–µ–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π.")
        return []

    # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ—Ä–Ω–µ–π x –∏–∑ y = x^2
    x_roots = []
    print(f"\nüîç –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ—Ä–Ω–µ–π x –∏–∑ y = x¬≤:")

    for i, y in enumerate(y_roots, 1):
        if y > 0:
            x1 = math.sqrt(y)
            x2 = -math.sqrt(y)
            x_roots.extend([x1, x2])
            print(f"  –ò–∑ y{i} = {y:.6f}: x = ¬±{x1:.6f}")
        elif y == 0:
            x_roots.append(0)
            print(f"  –ò–∑ y{i} = 0: x = 0")

    # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∫–æ—Ä–Ω–µ–π
    x_roots.sort()

    return x_roots


def print_results(roots: List[float]) -> None:
    """
    –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–µ—à–µ–Ω–∏—è.

    Args:
        roots: –°–ø–∏—Å–æ–∫ –∫–æ—Ä–Ω–µ–π
    """
    print("\n" + "="*60)
    print("üìã –†–ï–ó–£–õ–¨–¢–ê–¢–´:")
    print("="*60)

    if not roots:
        print("‚ùå –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π –Ω–µ—Ç.")
    else:
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ –∫–æ—Ä–Ω–µ–π: {len(roots)}")
        for i, root in enumerate(roots, 1):
            print(f"  x{i} = {root:.6f}")

    print("="*60 + "\n")


def main():
    """
    –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã.
    """
    print("\n" + "üéØ "*20)
    print("    –†–ï–®–ï–ù–ò–ï –ë–ò–ö–í–ê–î–†–ê–¢–ù–û–ì–û –£–†–ê–í–ù–ï–ù–ò–Ø")
    print("    A*x‚Å¥ + B*x¬≤ + C = 0")
    print("üéØ "*20 + "\n")

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
    args = sys.argv[1:]  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∏–º—è –ø—Ä–æ–≥—Ä–∞–º–º—ã

    # –î–æ–ø–æ–ª–Ω—è–µ–º None, –µ—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–µ–Ω—å—à–µ 3
    while len(args) < 3:
        args.append(None)

    print("üìù –í–≤–æ–¥ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤:\n")

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
    a = get_coefficient("–í–≤–µ–¥–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç A: ", args[0])
    b = get_coefficient("–í–≤–µ–¥–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç B: ", args[1])
    c = get_coefficient("–í–≤–µ–¥–∏—Ç–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç C: ", args[2])

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω—É–ª–µ–≤–æ–π —Å—Ç–∞—Ä—à–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç
    if a == 0:
        print("\n‚ö†Ô∏è  –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç A = 0, —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –±–∏–∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–º!")
        print("–†–µ—à–∞–µ–º –∫–∞–∫ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ B*x¬≤ + C = 0\n")

    # –†–µ—à–µ–Ω–∏–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è
    roots = solve_biquadratic(a, b, c)

    # –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    print_results(roots)


if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print("\n\nüëã –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.\n")
        sys.exit(0)
    except Exception as e:
        print(f"\n‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {e}\n")
        sys.exit(1)
